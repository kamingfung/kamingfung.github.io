<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Python | Ka Ming Fung, Ph.D.</title>
    <link>https://kamingfung.github.io/kamingfung.github.io.academic_cv/tags/python/</link>
      <atom:link href="https://kamingfung.github.io/kamingfung.github.io.academic_cv/tags/python/index.xml" rel="self" type="application/rss+xml" />
    <description>Python</description>
    <generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>en-us</language><lastBuildDate>Tue, 05 Mar 2024 00:05:04 -0400</lastBuildDate>
    <image>
      <url>https://kamingfung.github.io/kamingfung.github.io.academic_cv/media/icon_hu14322561806154635754.png</url>
      <title>Python</title>
      <link>https://kamingfung.github.io/kamingfung.github.io.academic_cv/tags/python/</link>
    </image>
    
    <item>
      <title>Finding shadows in images using Python&#39;s scikit-image package</title>
      <link>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/</link>
      <pubDate>Tue, 05 Mar 2024 00:05:04 -0400</pubDate>
      <guid>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/</guid>
      <description>&lt;h1 id=&#34;finding-shadows-in-images-using-pythons-scikit-image-package&#34;&gt;Finding shadows in images using Python&amp;rsquo;s &lt;code&gt;scikit-image&lt;/code&gt; package&lt;/h1&gt;
&lt;p&gt;Ever noticed how shadows can make photos look cool or kinda tricky for editing? Well, guess what? With some Python magic and a handy tool called scikit-image, you can become a shadow-busting wizard in no time!&lt;/p&gt;
&lt;p&gt;In this quick guide, we&amp;rsquo;re diving into the nifty world of shadow segmentation. Don&amp;rsquo;t worry; it&amp;rsquo;s just a fancy way of saying we&amp;rsquo;re going to teach you how to spot and separate shadows from the rest of your image. Why? Because sometimes you just need to clear things up a bit, whether you&amp;rsquo;re tweaking photos or working on a cool project that needs shadow detection.&lt;/p&gt;
&lt;p&gt;We&amp;rsquo;ll start with the basicsâ€”loading up an image and flipping it into HSV color space. This helps us really see where those sneaky shadows are hiding. Then, with a couple of smart tricks and some threshold magic, we&amp;rsquo;ll show you how to pinpoint those shadows. And to keep things neat, we&amp;rsquo;ll even clean up any small bits and bobs that don&amp;rsquo;t belong.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# %pip install numpy scikit-image matplotlib&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;numpy&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;np&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;skimage&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;plt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# get sample image&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;image_rgb&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;skimage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stereo_motorcycle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# sense check (show the image)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;skimage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;imshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;image_rgb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;matplotlib.image.AxesImage at 0x10c422f50&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;flex justify-center	&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;png&#34; srcset=&#34;
               /kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/sample_shadow_segmentation_5_1_hu2444524728741753772.webp 400w,
               /kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/sample_shadow_segmentation_5_1_hu8130987965567773011.webp 760w,
               /kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/sample_shadow_segmentation_5_1_hu13763805786673316091.webp 1200w&#34;
               src=&#34;https://kamingfung.github.io/kamingfung.github.io.academic_cv/kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/sample_shadow_segmentation_5_1_hu2444524728741753772.webp&#34;
               width=&#34;630&#34;
               height=&#34;436&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Convert the image to HSV color space&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;image_hsv&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;skimage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rgb2hsv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;image_rgb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;hue&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;image_hsv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;brightness&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;image_hsv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Find global threshold on the lightness and hue to detect dark (shadow) regions&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;brightness_thresh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;skimage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filters&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threshold_otsu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;brightness&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;hue_thresh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;skimage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filters&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;threshold_otsu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;hue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Create a mask for the shadow regions&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shadow_mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;image_hsv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;brightness_thresh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;image_hsv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;:,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hue_thresh&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Remove small objects from the mask&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shadow_mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;skimage&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;morphology&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;remove_small_objects&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shadow_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Mask the image with the shadow mask&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;image_masked&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ma&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;masked_where&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shadow_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shadow_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shadow_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transpose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;image_rgb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Display the original image and the shadow mask&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;subplots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;imshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;image_rgb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Original Image&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;off&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_aspect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;equal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;imshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;~&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shadow_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# cmap=&amp;#34;gray&amp;#34;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Shadow Mask (purple = shadow)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;off&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_aspect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;equal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;flex justify-center	&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;png&#34; srcset=&#34;
               /kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/sample_shadow_segmentation_9_0_hu14171549610828828833.webp 400w,
               /kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/sample_shadow_segmentation_9_0_hu4299294486589443593.webp 760w,
               /kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/sample_shadow_segmentation_9_0_hu12831045858939211134.webp 1200w&#34;
               src=&#34;https://kamingfung.github.io/kamingfung.github.io.academic_cv/kamingfung.github.io.academic_cv/post/2024-03-05-segment-shadow-python/sample_shadow_segmentation_9_0_hu14171549610828828833.webp&#34;
               width=&#34;760&#34;
               height=&#34;255&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Improved notebook to download buildings from Microsoft</title>
      <link>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2024-02-14-ms-buildings/</link>
      <pubDate>Wed, 14 Feb 2024 00:05:04 -0400</pubDate>
      <guid>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2024-02-14-ms-buildings/</guid>
      <description>&lt;!-- *Created by [Ka Ming Fung](kamingfung@link.cuhk.edu.hk)* --&gt;
&lt;p&gt;This notebook works with the &lt;a href=&#34;https://github.com/microsoft/GlobalMLBuildingFootprints&#34;&gt;Microsoft Building Footprint Dataset&lt;/a&gt; to download building footprints for a given area of interest (AOI). I modified the &lt;a href=&#34;https://github.com/victor-ka-ming-fung/GlobalMLBuildingFootprints/blob/main/examples/example_building_footprints.ipynb&#34;&gt;original notebook&lt;/a&gt; to download the data to output a parquet file of a GeoDataFrame of buildings, instead of GeoJSON.&lt;/p&gt;
&lt;p&gt;To find the Jupyter notebook version, please visit &lt;a href=&#34;https://github.com/victor-ka-ming-fung/GlobalMLBuildingFootprints/blob/improved_example_notebook/examples/example_building_footprints.ipynb&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# # &amp;#34;&amp;#34;&amp;#34;install packages if not already installed&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# %pip install --upgrade pandas geopandas shapely mercantile tqdm folium&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;set-up-environment-and-local-varialbles&#34;&gt;set up environment and local varialbles&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pandas&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;geopandas&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;gpd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;shapely.geometry&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;mercantile&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;tqdm&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tqdm&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;output_fn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;example_building_footprints.parquet&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;step-1---define-our-area-of-interest-aoi&#34;&gt;Step 1 - Define our area of interest (AOI)&lt;/h2&gt;
&lt;p&gt;We define our area of interest (or AOI) as a GeoJSON geometry, then use the &lt;code&gt;shapely&lt;/code&gt; library to get the bounding box.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: the coordinate reference system for the GeoJSON should be &amp;ldquo;EPSG:4326&amp;rdquo;, i.e. in global lat/lon format.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Geometry copied from https://geojson.io&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;aoi_geom&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;coordinates&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;122.16484503187519&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;47.69090474454916&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;122.16484503187519&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;47.6217555345674&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;122.06529607517405&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;47.6217555345674&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;122.06529607517405&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;47.69090474454916&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;122.16484503187519&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;47.69090474454916&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Polygon&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;aoi_shape&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shapely&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;geometry&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aoi_geom&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;minx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;miny&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;maxx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;maxy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;aoi_shape&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bounds&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;step-2---determine-which-tiles-intersect-our-aoi&#34;&gt;Step 2 - Determine which tiles intersect our AOI&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;Get tiles for a given bounding box and zoom level&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;quad_keys&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tile&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mercantile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;minx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;miny&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;maxx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;maxy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;zooms&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;quad_keys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mercantile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quadkey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;quad_keys&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quad_keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;The input area spans &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quad_keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; tiles: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quad_keys&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;The input area spans 1 tiles: [21230030]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;step-3---download-the-building-footprints-for-each-tile-that-intersects-our-aoi-and-crop-the-results&#34;&gt;Step 3 - Download the building footprints for each tile that intersects our AOI and crop the results&lt;/h2&gt;
&lt;p&gt;This is where most of the magic happens. We download all the building footprints for each tile that intersects our AOI, then only keep the footprints that are &lt;em&gt;contained&lt;/em&gt; by our AOI.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Note&lt;/em&gt;: this step might take awhile depending on how many tiles your AOI covers and how many buildings footprints are in those tiles.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# read the quads catalog&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read_csv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;https://minedbuildings.blob.core.windows.net/global-buildings/dataset-links.csv&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# extract urls for the quads we want&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;urls&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;df&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pipe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;QuadKey&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;isin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;quad_keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)])[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Url&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unique&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# download the quads and read as one consolidated pandas dataframe&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buildings_df_list&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read_json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lines&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tqdm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;urls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# concatenate the list of dataframes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buildings_df&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;concat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buildings_df_list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# concvert to geopandas dataframe&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buildings_gdf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;buildings_df&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pipe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gpd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GeoDataFrame&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;crs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4326&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;geometry&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;geometry&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shapely&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;geometry&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# retain the height information&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;assign&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;height_m&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;properties&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;apply&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;lambda&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;height&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;# drop the raw column for height and type&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;columns&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s2&#34;&gt;&amp;#34;properties&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ignore&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;  0%|          | 0/1 [00:00&amp;lt;?, ?it/s]
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# filter to buildings that intersect the AOI&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buildings_in_aoi_gdf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buildings_gdf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buildings_gdf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;intersects&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;aoi_shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;step-4---save-the-resulting-footprints-to-a-parquet-file&#34;&gt;Step 4 - Save the resulting footprints to a parquet file&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# write to parquet&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buildings_in_aoi_gdf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_parquet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output_fn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id=&#34;optional-sense-check&#34;&gt;Optional sense check&lt;/h1&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# interactive map&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# import folium&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# m = buildings_in_aoi_gdf.explore(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#     attr=&amp;#34;Google&amp;#34;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#     tiles=&amp;#34;https://mt1.google.com/vt/lyrs=s&amp;amp;x={x}&amp;amp;y={y}&amp;amp;z={z}&amp;#34;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# )&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# folium.TileLayer(&amp;#34;OpenStreetMap&amp;#34;).add_to(m)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# folium.LayerControl().add_to(m)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# m&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# static map&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buildings_in_aoi_gdf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;featured.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Learn Python</title>
      <link>https://kamingfung.github.io/kamingfung.github.io.academic_cv/teaching/python/</link>
      <pubDate>Tue, 24 Oct 2023 00:00:00 +0000</pubDate>
      <guid>https://kamingfung.github.io/kamingfung.github.io.academic_cv/teaching/python/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://hugoblox.com&#34;&gt;Hugo Blox Builder&lt;/a&gt; is designed to give technical content creators a seamless experience. You can focus on the content and the Hugo Blox Builder which this template is built upon handles the rest.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Embed videos, podcasts, code, LaTeX math, and even test students!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;On this page, you&amp;rsquo;ll find some examples of the types of technical content that can be rendered with Hugo Blox.&lt;/p&gt;
&lt;h2 id=&#34;video&#34;&gt;Video&lt;/h2&gt;
&lt;p&gt;Teach your course by sharing videos with your students. Choose from one of the following approaches:&lt;/p&gt;


    
    &lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
      &lt;iframe allow=&#34;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&#34; allowfullscreen=&#34;allowfullscreen&#34; loading=&#34;eager&#34; referrerpolicy=&#34;strict-origin-when-cross-origin&#34; src=&#34;https://www.youtube.com/embed/D2vj0WcvH5c?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; title=&#34;YouTube video&#34;
      &gt;&lt;/iframe&gt;
    &lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Youtube&lt;/strong&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{{&amp;lt; youtube w7Ft2ymGmfc &amp;gt;}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Bilibili&lt;/strong&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{{&amp;lt; bilibili id=&amp;quot;BV1WV4y1r7DF&amp;quot; &amp;gt;}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Video file&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Videos may be added to a page by either placing them in your &lt;code&gt;assets/media/&lt;/code&gt; media library or in your &lt;a href=&#34;https://gohugo.io/content-management/page-bundles/&#34;&gt;page&amp;rsquo;s folder&lt;/a&gt;, and then embedding them with the &lt;em&gt;video&lt;/em&gt; shortcode:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{{&amp;lt; video src=&amp;quot;my_video.mp4&amp;quot; controls=&amp;quot;yes&amp;quot; &amp;gt;}}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;podcast&#34;&gt;Podcast&lt;/h2&gt;
&lt;p&gt;You can add a podcast or music to a page by placing the MP3 file in the page&amp;rsquo;s folder or the media library folder and then embedding the audio on your page with the &lt;em&gt;audio&lt;/em&gt; shortcode:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{{&amp;lt; audio src=&amp;quot;ambient-piano.mp3&amp;quot; &amp;gt;}}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Try it out:&lt;/p&gt;








  








&lt;audio controls &gt;
  &lt;source src=&#34;https://kamingfung.github.io/kamingfung.github.io.academic_cv/kamingfung.github.io.academic_cv/teaching/python/ambient-piano.mp3&#34; type=&#34;audio/mpeg&#34;&gt;
&lt;/audio&gt;

&lt;h2 id=&#34;test-students&#34;&gt;Test students&lt;/h2&gt;
&lt;p&gt;Provide a simple yet fun self-assessment by revealing the solutions to challenges with the &lt;code&gt;spoiler&lt;/code&gt; shortcode:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-markdown&#34; data-lang=&#34;markdown&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nt&#34;&gt;spoiler&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ðŸ‘‰ Click to view the solution&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;}}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;You found me!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spoiler&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;}}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;renders as&lt;/p&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-2&#34;&gt;
  &lt;summary class=&#34;cursor-pointer&#34;&gt;ðŸ‘‰ Click to view the solution&lt;/summary&gt;
  &lt;div class=&#34;rounded-lg bg-neutral-50 dark:bg-neutral-800 p-2&#34;&gt;
    You found me ðŸŽ‰
  &lt;/div&gt;
&lt;/details&gt;
&lt;h2 id=&#34;math&#34;&gt;Math&lt;/h2&gt;
&lt;p&gt;Hugo Blox Builder supports a Markdown extension for $\LaTeX$ math. You can enable this feature by toggling the &lt;code&gt;math&lt;/code&gt; option in your &lt;code&gt;config/_default/params.yaml&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;To render &lt;em&gt;inline&lt;/em&gt; or &lt;em&gt;block&lt;/em&gt; math, wrap your LaTeX math with &lt;code&gt;{{&amp;lt; math &amp;gt;}}$...${{&amp;lt; /math &amp;gt;}}&lt;/code&gt; or &lt;code&gt;{{&amp;lt; math &amp;gt;}}$$...$${{&amp;lt; /math &amp;gt;}}&lt;/code&gt;, respectively.&lt;/p&gt;
&lt;div class=&#34;flex px-4 py-3 mb-6 rounded-md bg-primary-100 dark:bg-primary-900&#34;&gt;
&lt;span class=&#34;pr-3 pt-1 text-primary-600 dark:text-primary-300&#34;&gt;
  &lt;svg height=&#34;24&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 24 24&#34;&gt;&lt;path fill=&#34;none&#34; stroke=&#34;currentColor&#34; stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; stroke-width=&#34;1.5&#34; d=&#34;m11.25 11.25l.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0m-9-3.75h.008v.008H12z&#34;/&gt;&lt;/svg&gt;
&lt;/span&gt;
  &lt;span class=&#34;dark:text-neutral-300&#34;&gt;We wrap the LaTeX math in the Hugo Blox &lt;em&gt;math&lt;/em&gt; shortcode to prevent Hugo rendering our math as Markdown.&lt;/span&gt;
&lt;/div&gt;
&lt;p&gt;Example &lt;strong&gt;math block&lt;/strong&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;{{&lt;/span&gt;&amp;lt; math &amp;gt;&lt;span class=&#34;nb&#34;&gt;}}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sb&#34;&gt;$$&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\gamma&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;_{n} &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\frac&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;{ &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\left&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; | &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\left&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\mathbf&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; x_{n} &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\mathbf&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; x_{n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;} &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\right&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;^T &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\left&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\nabla&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; F &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\mathbf&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; x_{n}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\nabla&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; F &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\mathbf&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; x_{n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\right&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\right&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; |}{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\left&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\|\nabla&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; F&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\mathbf&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;{x}_{n}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\nabla&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; F&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\mathbf&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;{x}_{n&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\right&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\|&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;^&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;$$&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;{{&lt;/span&gt;&amp;lt; /math &amp;gt;&lt;span class=&#34;nb&#34;&gt;}}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;renders as&lt;/p&gt;

$$\gamma_{n} = \frac{ \left | \left (\mathbf x_{n} - \mathbf x_{n-1} \right )^T \left [\nabla F (\mathbf x_{n}) - \nabla F (\mathbf x_{n-1}) \right ] \right |}{\left \|\nabla F(\mathbf{x}_{n}) - \nabla F(\mathbf{x}_{n-1}) \right \|^2}$$


&lt;p&gt;Example &lt;strong&gt;inline math&lt;/strong&gt; &lt;code&gt;{{&amp;lt; math &amp;gt;}}$\nabla F(\mathbf{x}_{n})${{&amp;lt; /math &amp;gt;}}&lt;/code&gt; renders as $\nabla F(\mathbf{x}_{n})$
.&lt;/p&gt;
&lt;p&gt;Example &lt;strong&gt;multi-line math&lt;/strong&gt; using the math linebreak (&lt;code&gt;\\&lt;/code&gt;):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-latex&#34; data-lang=&#34;latex&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;{{&lt;/span&gt;&amp;lt; math &amp;gt;&lt;span class=&#34;nb&#34;&gt;}}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sb&#34;&gt;$$&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;k;p_{&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;}^{&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\begin&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;{cases}p_{&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;}^{&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;} &amp;amp; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\text&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;{if }k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;, &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;p_{&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;}^{&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;} &amp;amp; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\text&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;{if }k&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;\end&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;{cases}&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;$$&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;{{&lt;/span&gt;&amp;lt; /math &amp;gt;&lt;span class=&#34;nb&#34;&gt;}}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;renders as&lt;/p&gt;


$$
f(k;p_{0}^{*}) = \begin{cases}p_{0}^{*} &amp; \text{if }k=1, \\
1-p_{0}^{*} &amp; \text{if }k=0.\end{cases}
$$



&lt;h2 id=&#34;code&#34;&gt;Code&lt;/h2&gt;
&lt;p&gt;Hugo Blox Builder utilises Hugo&amp;rsquo;s Markdown extension for highlighting code syntax. The code theme can be selected in the &lt;code&gt;config/_default/params.yaml&lt;/code&gt; file.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;```python
import pandas as pd
data = pd.read_csv(&amp;quot;data.csv&amp;quot;)
data.head()
```
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;renders as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pandas&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read_csv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;data.csv&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;inline-images&#34;&gt;Inline Images&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{{&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;icon&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;python&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;}}&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;renders as&lt;/p&gt;
&lt;p&gt;
  &lt;span class=&#34;inline-block  pr-1&#34;&gt;
    &lt;svg style=&#34;height: 1em; transform: translateY(0.1em);&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; height=&#34;1em&#34; viewBox=&#34;0 0 448 512&#34; fill=&#34;currentColor&#34;&gt;&lt;path d=&#34;M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z&#34;/&gt;&lt;/svg&gt;
  &lt;/span&gt; Python&lt;/p&gt;
&lt;h2 id=&#34;did-you-find-this-page-helpful-consider-sharing-it-&#34;&gt;Did you find this page helpful? Consider sharing it ðŸ™Œ&lt;/h2&gt;
</description>
    </item>
    
    <item>
      <title>Scaling a Subset of Input Data in NetCDF Format</title>
      <link>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2021-02-11-partial_scaling/</link>
      <pubDate>Wed, 10 Feb 2021 00:05:04 -0400</pubDate>
      <guid>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2021-02-11-partial_scaling/</guid>
      <description>&lt;!-- *Created by [Ka Ming Fung](kamingfung@link.cuhk.edu.hk)* --&gt;
&lt;p&gt;&lt;em&gt;Reference:&lt;/em&gt;
For general python handling of nc files using Xarray: &lt;a href=&#34;http://xarray.pydata.org/en/stable/index.html&#34;&gt;http://xarray.pydata.org/en/stable/index.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I am working on a set of input data of Ocean DMS concentration. I suspect the reported values over the Southern Ocean (vaguely defined as ocean south to 30ÂºS) is a bit high. I want to reduce those values by 50% to see if my model will match observations better.&lt;/p&gt;
&lt;p&gt;Surprisingly, I didn&amp;rsquo;t find a quick way to do it. Here I present a work-a-round. (Please let me know if you have a smarter way.)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;wget&lt;/span&gt;                        &lt;span class=&#34;c1&#34;&gt;# for downloading data via URL links&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;xarray&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;xr&lt;/span&gt;                   &lt;span class=&#34;c1&#34;&gt;# the major tool to work with NetCDF data!&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;matplotlib&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pyplot&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# for plotting&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;open-the-monthly-ocean-dms-nc-file&#34;&gt;Open the monthly Ocean DMS nc file&lt;/h2&gt;
&lt;p&gt;The marine DMS data used in this example can be downloaded &lt;a href=&#34;http://rain.ucis.dal.ca/ctm/HEMCO/DMS/v2015-07/DMS_lana.geos.1x1.nc&#34;&gt;here&lt;/a&gt;. Or, we can download it from &lt;code&gt;Python&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;wget&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;download&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http://rain.ucis.dal.ca/ctm/HEMCO/DMS/v2015-07/DMS_lana.geos.1x1.nc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&#39;DMS_lana.geos.1x1.nc&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We will use the function &lt;code&gt;xr.open_dataset&lt;/code&gt; from the xarray package.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;open_dataset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;DMS_lana.geos.1x1.nc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# display the dataset&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;svg style=&#34;position: absolute; width: 0; height: 0; overflow: hidden&#34;&gt;
&lt;defs&gt;
&lt;symbol id=&#34;icon-database&#34; viewBox=&#34;0 0 32 32&#34;&gt;
&lt;path d=&#34;M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z&#34;&gt;&lt;/path&gt;
&lt;/symbol&gt;
&lt;symbol id=&#34;icon-file-text2&#34; viewBox=&#34;0 0 32 32&#34;&gt;
&lt;path d=&#34;M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;/symbol&gt;
&lt;/defs&gt;
&lt;/svg&gt;
&lt;style&gt;/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */
&lt;p&gt;:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p&gt;
&lt;p&gt;html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p&gt;
&lt;p&gt;.xr-wrap {
display: block;
min-width: 300px;
max-width: 700px;
}&lt;/p&gt;
&lt;p&gt;.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p&gt;
&lt;p&gt;.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;â–º&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;â–¼&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p&gt;
&lt;p&gt;.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p&gt;
&lt;p&gt;.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p&gt;
&lt;p&gt;.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p&gt;
&lt;p&gt;.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p&gt;
&lt;p&gt;.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list:before {
content: &amp;lsquo;(&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list:after {
content: &amp;lsquo;)&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,&amp;rsquo;;
padding-right: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-has-index {
font-weight: bold;
}&lt;/p&gt;
&lt;p&gt;.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p&gt;
&lt;p&gt;.xr-var-name {
grid-column: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-var-dims {
grid-column: 2;
}&lt;/p&gt;
&lt;p&gt;.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-var-preview {
grid-column: 4;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p&gt;
&lt;p&gt;.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p&gt;
&lt;p&gt;.xr-var-data &amp;gt; table {
float: right;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p&gt;
&lt;p&gt;dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt, dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p&gt;
&lt;p&gt;.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style&gt;&lt;pre class=&#39;xr-text-repr-fallback&#39;&gt;&amp;lt;xarray.Dataset&amp;gt;
Dimensions:    (lat: 181, lon: 360, time: 12)
Coordinates:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;lon        (lon) float32 -180.0 -179.0 -178.0 -177.0 &amp;hellip; 177.0 178.0 179.0&lt;/li&gt;
&lt;li&gt;lat        (lat) float32 -89.75 -89.0 -88.0 -87.0 &amp;hellip; 87.0 88.0 89.0 89.75&lt;/li&gt;
&lt;li&gt;time       (time) datetime64[ns] 1985-01-01 1985-02-01 &amp;hellip; 1985-12-01
Data variables:
DMS_OCEAN  (time, lat, lon) float32 &amp;hellip;
Attributes:
CDI:          Climate Data Interface version 1.6.4 (&lt;a href=&#34;http://code.zmaw.de/p&#34;&gt;http://code.zmaw.de/p&lt;/a&gt;&amp;hellip;
Conventions:  COARDS
history:      Mon Jul 20 16:29:35 2015: ncatted -O -a units,DMS_OCEAN,o,c&amp;hellip;
Title:        COARDS/netCDF file created by BPCH2COARDS (GAMAP v2-17+)
Format:       NetCDF-3
Model:        GEOS5_47L
Delta_Lon:    1.0
Delta_Lat:    1.0
NLayers:      47
Start_Date:   19850101
Start_Time:   0
End_Date:     19850201
End_Time:     0
Delta_Time:   744
CDO:          Climate Data Operators version 1.6.4 (&lt;a href=&#34;http://code.zmaw.de/p&#34;&gt;http://code.zmaw.de/p&lt;/a&gt;&amp;hellip;&lt;/pre&gt;&lt;div class=&#39;xr-wrap&#39; hidden&gt;&lt;div class=&#39;xr-header&#39;&gt;&lt;div class=&#39;xr-obj-type&#39;&gt;xarray.Dataset&lt;/div&gt;&lt;/div&gt;&lt;ul class=&#39;xr-sections&#39;&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-abe64baa-5fc8-49a7-b3ba-4a364c068cdf&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39; disabled &gt;&lt;label for=&#39;section-abe64baa-5fc8-49a7-b3ba-4a364c068cdf&#39; class=&#39;xr-section-summary&#39;  title=&#39;Expand/collapse section&#39;&gt;Dimensions:&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;ul class=&#39;xr-dim-list&#39;&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lat&lt;/span&gt;: 181&lt;/li&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lon&lt;/span&gt;: 360&lt;/li&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;time&lt;/span&gt;: 12&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-642e9103-e95f-43fb-b9d3-d8365b57f982&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39;  checked&gt;&lt;label for=&#39;section-642e9103-e95f-43fb-b9d3-d8365b57f982&#39; class=&#39;xr-section-summary&#39; &gt;Coordinates: &lt;span&gt;(3)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;ul class=&#39;xr-var-list&#39;&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lon&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(lon)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float32&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;-180.0 -179.0 &amp;hellip; 178.0 179.0&lt;/div&gt;&lt;input id=&#39;attrs-9a41ee56-82dc-46aa-8d42-73272e1c0e30&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-9a41ee56-82dc-46aa-8d42-73272e1c0e30&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-75db8d25-3657-4178-84b3-8d8b401a886c&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-75db8d25-3657-4178-84b3-8d8b401a886c&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;longitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Longitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;units :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;degrees_east&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;axis :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;X&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([-180., -179., -178., &amp;hellip;,  177.,  178.,  179.], dtype=float32)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lat&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(lat)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float32&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;-89.75 -89.0 -88.0 &amp;hellip; 89.0 89.75&lt;/div&gt;&lt;input id=&#39;attrs-24b632a5-b6e2-40e9-b87e-e84f2db17d2f&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-24b632a5-b6e2-40e9-b87e-e84f2db17d2f&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-f94225c1-1a1f-4220-8924-5fdd2fac969f&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-f94225c1-1a1f-4220-8924-5fdd2fac969f&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;latitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Latitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;units :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;degrees_north&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;axis :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Y&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([-89.75, -89.  , -88.  , -87.  , -86.  , -85.  , -84.  , -83.  , -82.  ,
-81.  , -80.  , -79.  , -78.  , -77.  , -76.  , -75.  , -74.  , -73.  ,
-72.  , -71.  , -70.  , -69.  , -68.  , -67.  , -66.  , -65.  , -64.  ,
-63.  , -62.  , -61.  , -60.  , -59.  , -58.  , -57.  , -56.  , -55.  ,
-54.  , -53.  , -52.  , -51.  , -50.  , -49.  , -48.  , -47.  , -46.  ,
-45.  , -44.  , -43.  , -42.  , -41.  , -40.  , -39.  , -38.  , -37.  ,
-36.  , -35.  , -34.  , -33.  , -32.  , -31.  , -30.  , -29.  , -28.  ,
-27.  , -26.  , -25.  , -24.  , -23.  , -22.  , -21.  , -20.  , -19.  ,
-18.  , -17.  , -16.  , -15.  , -14.  , -13.  , -12.  , -11.  , -10.  ,
-9.  ,  -8.  ,  -7.  ,  -6.  ,  -5.  ,  -4.  ,  -3.  ,  -2.  ,  -1.  ,
0.  ,   1.  ,   2.  ,   3.  ,   4.  ,   5.  ,   6.  ,   7.  ,   8.  ,
9.  ,  10.  ,  11.  ,  12.  ,  13.  ,  14.  ,  15.  ,  16.  ,  17.  ,
18.  ,  19.  ,  20.  ,  21.  ,  22.  ,  23.  ,  24.  ,  25.  ,  26.  ,
27.  ,  28.  ,  29.  ,  30.  ,  31.  ,  32.  ,  33.  ,  34.  ,  35.  ,
36.  ,  37.  ,  38.  ,  39.  ,  40.  ,  41.  ,  42.  ,  43.  ,  44.  ,
45.  ,  46.  ,  47.  ,  48.  ,  49.  ,  50.  ,  51.  ,  52.  ,  53.  ,
54.  ,  55.  ,  56.  ,  57.  ,  58.  ,  59.  ,  60.  ,  61.  ,  62.  ,
63.  ,  64.  ,  65.  ,  66.  ,  67.  ,  68.  ,  69.  ,  70.  ,  71.  ,
72.  ,  73.  ,  74.  ,  75.  ,  76.  ,  77.  ,  78.  ,  79.  ,  80.  ,
81.  ,  82.  ,  83.  ,  84.  ,  85.  ,  86.  ,  87.  ,  88.  ,  89.  ,
89.75], dtype=float32)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;time&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(time)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;datetime64[ns]&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;1985-01-01 &amp;hellip; 1985-12-01&lt;/div&gt;&lt;input id=&#39;attrs-50142612-8e1e-43ae-9b1f-0ba7f87a9393&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-50142612-8e1e-43ae-9b1f-0ba7f87a9393&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-d49df175-4681-4ae2-b18c-5cb5f9e7804a&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-d49df175-4681-4ae2-b18c-5cb5f9e7804a&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;time&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Time&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([&#39;1985-01-01T00:00:00.000000000&#39;, &#39;1985-02-01T00:00:00.000000000&#39;,
&#39;1985-03-01T00:00:00.000000000&#39;, &#39;1985-04-01T00:00:00.000000000&#39;,
&#39;1985-05-01T00:00:00.000000000&#39;, &#39;1985-06-01T00:00:00.000000000&#39;,
&#39;1985-07-01T00:00:00.000000000&#39;, &#39;1985-08-01T00:00:00.000000000&#39;,
&#39;1985-09-01T00:00:00.000000000&#39;, &#39;1985-10-01T00:00:00.000000000&#39;,
&#39;1985-11-01T00:00:00.000000000&#39;, &#39;1985-12-01T00:00:00.000000000&#39;],
dtype=&#39;datetime64[ns]&#39;)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-2261ebde-fb9d-4482-b19d-34384d1b9e72&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39;  checked&gt;&lt;label for=&#39;section-2261ebde-fb9d-4482-b19d-34384d1b9e72&#39; class=&#39;xr-section-summary&#39; &gt;Data variables: &lt;span&gt;(1)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;ul class=&#39;xr-var-list&#39;&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span&gt;DMS_OCEAN&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(time, lat, lon)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float32&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;&amp;hellip;&lt;/div&gt;&lt;input id=&#39;attrs-39a30321-8ea6-4dd4-a205-25577e5f39a9&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-39a30321-8ea6-4dd4-a205-25577e5f39a9&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-5b8b78c1-6e24-494e-8a59-06ca71183378&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-5b8b78c1-6e24-494e-8a59-06ca71183378&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Ocean DMS concentration&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;units :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;kg/m3&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;[781920 values with dtype=float32]&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-fe360d48-b8de-4324-98eb-113dd86753af&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39;  &gt;&lt;label for=&#39;section-fe360d48-b8de-4324-98eb-113dd86753af&#39; class=&#39;xr-section-summary&#39; &gt;Attributes: &lt;span&gt;(15)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;CDI :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Climate Data Interface version 1.6.4 (&lt;a href=&#34;http://code.zmaw.de/projects/cdi&#34;&gt;http://code.zmaw.de/projects/cdi&lt;/a&gt;)&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Conventions :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;COARDS&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;history :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Mon Jul 20 16:29:35 2015: ncatted -O -a units,DMS_OCEAN,o,c,kg/m3 tmp3.nc
Mon Jul 20 16:29:34 2015: cdo mulc,6.213e-8 tmp2.nc tmp3.nc
Mon Jul 20 16:29:34 2015: cdo chname,BIOGSRCE__DMSOCN,DMS_OCEAN tmp.nc tmp2.nc
Mon Jul 20 16:29:34 2015: cdo mergetime tmp.1985*.nc tmp.nc&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Title :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;COARDS/netCDF file created by BPCH2COARDS (GAMAP v2-17+)&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Format :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;NetCDF-3&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Model :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;GEOS5_47L&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Delta_Lon :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;1.0&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Delta_Lat :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;1.0&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;NLayers :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;47&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Start_Date :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;19850101&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Start_Time :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;0&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;End_Date :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;19850201&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;End_Time :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;0&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Delta_Time :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;744&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;CDO :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Climate Data Operators version 1.6.4 (&lt;a href=&#34;http://code.zmaw.de/projects/cdo&#34;&gt;http://code.zmaw.de/projects/cdo&lt;/a&gt;)&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We can also visualize annual mean of the data for a quick check:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;DMS_OCEAN&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;matplotlib.collections.QuadMesh at 0x7fd61bbd01f0&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_7_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;scaling-down-the-southern-ocean-dms&#34;&gt;Scaling down the Southern Ocean DMS&lt;/h2&gt;
&lt;p&gt;As mentioned, we want to scale down the ocean DMS below 30ÂºS.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Step 1: make two copies of the data set, one for grid cells with lat &amp;gt; 30ÂºS, one for &amp;lt;30ÂºS&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dms_above30S&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;DMS_OCEAN&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;slice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dms_below30S&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;DMS_OCEAN&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;slice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e-9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# we add a small value here to avoid the grid cells with lat = 30ÂºS to appear in both data sets.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Step 2: reduce the DMS in the dataset of interest by 50% &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dms_below30S&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dms_below30S&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Step 3: merge the untouched and scaled data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds_partly_scaled&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;merge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dms_below30S&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dms_above30S&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;compat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;no_conflicts&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To ensure our exercise is correct, let&amp;rsquo;s make some plots to compare the DMS concentrations in &lt;code&gt;ds_partly_scaled&lt;/code&gt; and the original dataset, &lt;code&gt;ds&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ds_partly_scaled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;DMS_OCEAN&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;DMS_OCEAN&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;col&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;col_wrap&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;xarray.plot.facetgrid.FacetGrid at 0x7fd61bd3ba00&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_11_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Yellow = 1 (untouched); Purple = 0.5(scaled). Mission accomplished?&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds_partly_scaled&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# missing attributes from the original dataset.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;svg style=&#34;position: absolute; width: 0; height: 0; overflow: hidden&#34;&gt;
&lt;defs&gt;
&lt;symbol id=&#34;icon-database&#34; viewBox=&#34;0 0 32 32&#34;&gt;
&lt;path d=&#34;M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z&#34;&gt;&lt;/path&gt;
&lt;/symbol&gt;
&lt;symbol id=&#34;icon-file-text2&#34; viewBox=&#34;0 0 32 32&#34;&gt;
&lt;path d=&#34;M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;/symbol&gt;
&lt;/defs&gt;
&lt;/svg&gt;
&lt;style&gt;/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */
&lt;p&gt;:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p&gt;
&lt;p&gt;html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p&gt;
&lt;p&gt;.xr-wrap {
display: block;
min-width: 300px;
max-width: 700px;
}&lt;/p&gt;
&lt;p&gt;.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p&gt;
&lt;p&gt;.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;â–º&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;â–¼&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p&gt;
&lt;p&gt;.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p&gt;
&lt;p&gt;.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p&gt;
&lt;p&gt;.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p&gt;
&lt;p&gt;.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p&gt;
&lt;p&gt;.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list:before {
content: &amp;lsquo;(&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list:after {
content: &amp;lsquo;)&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,&amp;rsquo;;
padding-right: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-has-index {
font-weight: bold;
}&lt;/p&gt;
&lt;p&gt;.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p&gt;
&lt;p&gt;.xr-var-name {
grid-column: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-var-dims {
grid-column: 2;
}&lt;/p&gt;
&lt;p&gt;.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-var-preview {
grid-column: 4;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p&gt;
&lt;p&gt;.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p&gt;
&lt;p&gt;.xr-var-data &amp;gt; table {
float: right;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p&gt;
&lt;p&gt;dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt, dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p&gt;
&lt;p&gt;.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style&gt;&lt;pre class=&#39;xr-text-repr-fallback&#39;&gt;&amp;lt;xarray.Dataset&amp;gt;
Dimensions:    (lat: 181, lon: 360, time: 12)
Coordinates:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;lat        (lat) float64 -89.75 -89.0 -88.0 -87.0 &amp;hellip; 87.0 88.0 89.0 89.75&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;lon        (lon) float32 -180.0 -179.0 -178.0 -177.0 &amp;hellip; 177.0 178.0 179.0&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;time       (time) datetime64[ns] 1985-01-01 1985-02-01 &amp;hellip; 1985-12-01
Data variables:
DMS_OCEAN  (time, lat, lon) float32 0.0 0.0 &amp;hellip; 1.4103641e-07 1.4103641e-07&lt;/pre&gt;&lt;div class=&#39;xr-wrap&#39; hidden&gt;&lt;div class=&#39;xr-header&#39;&gt;&lt;div class=&#39;xr-obj-type&#39;&gt;xarray.Dataset&lt;/div&gt;&lt;/div&gt;&lt;ul class=&#39;xr-sections&#39;&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-17444cc6-5a67-4fb6-9c64-f5307333029d&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39; disabled &gt;&lt;label for=&#39;section-17444cc6-5a67-4fb6-9c64-f5307333029d&#39; class=&#39;xr-section-summary&#39;  title=&#39;Expand/collapse section&#39;&gt;Dimensions:&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;ul class=&#39;xr-dim-list&#39;&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lat&lt;/span&gt;: 181&lt;/li&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lon&lt;/span&gt;: 360&lt;/li&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;time&lt;/span&gt;: 12&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-3f37bb3c-e560-4916-85b7-5008f191f325&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39;  checked&gt;&lt;label for=&#39;section-3f37bb3c-e560-4916-85b7-5008f191f325&#39; class=&#39;xr-section-summary&#39; &gt;Coordinates: &lt;span&gt;(3)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;ul class=&#39;xr-var-list&#39;&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lat&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(lat)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float64&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;-89.75 -89.0 -88.0 &amp;hellip; 89.0 89.75&lt;/div&gt;&lt;input id=&#39;attrs-c3f93ecb-1c2e-41d0-b3e6-dc22c2756bd5&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-c3f93ecb-1c2e-41d0-b3e6-dc22c2756bd5&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-57e895b5-1928-4415-b1f1-cfc1ddf73f6e&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-57e895b5-1928-4415-b1f1-cfc1ddf73f6e&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;latitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Latitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;units :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;degrees_north&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;axis :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Y&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([-89.75, -89.  , -88.  , -87.  , -86.  , -85.  , -84.  , -83.  , -82.  ,
-81.  , -80.  , -79.  , -78.  , -77.  , -76.  , -75.  , -74.  , -73.  ,
-72.  , -71.  , -70.  , -69.  , -68.  , -67.  , -66.  , -65.  , -64.  ,
-63.  , -62.  , -61.  , -60.  , -59.  , -58.  , -57.  , -56.  , -55.  ,
-54.  , -53.  , -52.  , -51.  , -50.  , -49.  , -48.  , -47.  , -46.  ,
-45.  , -44.  , -43.  , -42.  , -41.  , -40.  , -39.  , -38.  , -37.  ,
-36.  , -35.  , -34.  , -33.  , -32.  , -31.  , -30.  , -29.  , -28.  ,
-27.  , -26.  , -25.  , -24.  , -23.  , -22.  , -21.  , -20.  , -19.  ,
-18.  , -17.  , -16.  , -15.  , -14.  , -13.  , -12.  , -11.  , -10.  ,
-9.  ,  -8.  ,  -7.  ,  -6.  ,  -5.  ,  -4.  ,  -3.  ,  -2.  ,  -1.  ,
0.  ,   1.  ,   2.  ,   3.  ,   4.  ,   5.  ,   6.  ,   7.  ,   8.  ,
9.  ,  10.  ,  11.  ,  12.  ,  13.  ,  14.  ,  15.  ,  16.  ,  17.  ,
18.  ,  19.  ,  20.  ,  21.  ,  22.  ,  23.  ,  24.  ,  25.  ,  26.  ,
27.  ,  28.  ,  29.  ,  30.  ,  31.  ,  32.  ,  33.  ,  34.  ,  35.  ,
36.  ,  37.  ,  38.  ,  39.  ,  40.  ,  41.  ,  42.  ,  43.  ,  44.  ,
45.  ,  46.  ,  47.  ,  48.  ,  49.  ,  50.  ,  51.  ,  52.  ,  53.  ,
54.  ,  55.  ,  56.  ,  57.  ,  58.  ,  59.  ,  60.  ,  61.  ,  62.  ,
63.  ,  64.  ,  65.  ,  66.  ,  67.  ,  68.  ,  69.  ,  70.  ,  71.  ,
72.  ,  73.  ,  74.  ,  75.  ,  76.  ,  77.  ,  78.  ,  79.  ,  80.  ,
81.  ,  82.  ,  83.  ,  84.  ,  85.  ,  86.  ,  87.  ,  88.  ,  89.  ,
89.75])&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lon&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(lon)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float32&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;-180.0 -179.0 &amp;hellip; 178.0 179.0&lt;/div&gt;&lt;input id=&#39;attrs-77de3493-ba20-4259-aade-0552c4122503&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-77de3493-ba20-4259-aade-0552c4122503&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-ac7d445a-d799-41a3-82e0-2c654e86b91c&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-ac7d445a-d799-41a3-82e0-2c654e86b91c&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;longitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Longitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;units :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;degrees_east&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;axis :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;X&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([-180., -179., -178., &amp;hellip;,  177.,  178.,  179.], dtype=float32)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;time&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(time)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;datetime64[ns]&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;1985-01-01 &amp;hellip; 1985-12-01&lt;/div&gt;&lt;input id=&#39;attrs-bc8aea16-0715-4b47-874c-1c5d80d49704&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-bc8aea16-0715-4b47-874c-1c5d80d49704&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-d93d2b52-46fa-4f06-bbb0-3fe77d69f3de&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-d93d2b52-46fa-4f06-bbb0-3fe77d69f3de&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;time&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Time&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([&#39;1985-01-01T00:00:00.000000000&#39;, &#39;1985-02-01T00:00:00.000000000&#39;,
&#39;1985-03-01T00:00:00.000000000&#39;, &#39;1985-04-01T00:00:00.000000000&#39;,
&#39;1985-05-01T00:00:00.000000000&#39;, &#39;1985-06-01T00:00:00.000000000&#39;,
&#39;1985-07-01T00:00:00.000000000&#39;, &#39;1985-08-01T00:00:00.000000000&#39;,
&#39;1985-09-01T00:00:00.000000000&#39;, &#39;1985-10-01T00:00:00.000000000&#39;,
&#39;1985-11-01T00:00:00.000000000&#39;, &#39;1985-12-01T00:00:00.000000000&#39;],
dtype=&#39;datetime64[ns]&#39;)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-c9a6366a-fcc8-4c05-b744-634b39582ad3&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39;  checked&gt;&lt;label for=&#39;section-c9a6366a-fcc8-4c05-b744-634b39582ad3&#39; class=&#39;xr-section-summary&#39; &gt;Data variables: &lt;span&gt;(1)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;ul class=&#39;xr-var-list&#39;&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span&gt;DMS_OCEAN&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(time, lat, lon)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float32&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;0.0 0.0 &amp;hellip; 1.4103641e-07&lt;/div&gt;&lt;input id=&#39;attrs-206873f1-ffe6-4a00-9c38-8fb338a750a3&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; disabled&gt;&lt;label for=&#39;attrs-206873f1-ffe6-4a00-9c38-8fb338a750a3&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-fb80e9d1-5ef5-4f5b-8c42-a637f5e82c67&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-fb80e9d1-5ef5-4f5b-8c42-a637f5e82c67&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([[[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
&amp;hellip;,
[1.0823291e-07, 1.0823291e-07, 1.0823291e-07, &amp;hellip;,
1.0823291e-07, 1.0823291e-07, 1.0823291e-07],
[1.0823292e-07, 1.0823292e-07, 1.0823292e-07, &amp;hellip;,
1.0823292e-07, 1.0823292e-07, 1.0823292e-07],
[2.1647536e-07, 2.1647536e-07, 2.1647536e-07, &amp;hellip;,
2.1647536e-07, 2.1647536e-07, 2.1647536e-07]],&lt;/p&gt;
&lt;p&gt;[[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
&amp;hellip;
[4.1650505e-08, 4.1650505e-08, 4.1650505e-08, &amp;hellip;,
4.1650505e-08, 4.1650505e-08, 4.1650505e-08],
[4.1650505e-08, 4.1650505e-08, 4.1650505e-08, &amp;hellip;,
4.1650505e-08, 4.1650505e-08, 4.1650505e-08],
[8.3304677e-08, 8.3304677e-08, 8.3304677e-08, &amp;hellip;,
8.3304677e-08, 8.3304677e-08, 8.3304677e-08]],&lt;/p&gt;
&lt;p&gt;[[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
&amp;hellip;,
[7.0515100e-08, 7.0515100e-08, 7.0515100e-08, &amp;hellip;,
7.0515100e-08, 7.0515100e-08, 7.0515100e-08],
[7.0515107e-08, 7.0515107e-08, 7.0515107e-08, &amp;hellip;,
7.0515107e-08, 7.0515107e-08, 7.0515107e-08],
[1.4103641e-07, 1.4103641e-07, 1.4103641e-07, &amp;hellip;,
1.4103641e-07, 1.4103641e-07, 1.4103641e-07]]], dtype=float32)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-7d38814c-2b4b-4a64-b9af-a8732a4af998&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39; disabled &gt;&lt;label for=&#39;section-7d38814c-2b4b-4a64-b9af-a8732a4af998&#39; class=&#39;xr-section-summary&#39;  title=&#39;Expand/collapse section&#39;&gt;Attributes: &lt;span&gt;(0)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;/dl&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;preserving-metadata-from-the-original-nc-file&#34;&gt;Preserving metadata from the original nc file&lt;/h2&gt;
&lt;p&gt;Not yet! Now the new merged data set is missing the Attributes of the original.&lt;/p&gt;
&lt;p&gt;To fix this, we need to make a xarray copy of the original to preserve the original information, but with the new scaled values.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds_new&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;copy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ds_partly_scaled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds_new&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# now with the Attributes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;&lt;svg style=&#34;position: absolute; width: 0; height: 0; overflow: hidden&#34;&gt;
&lt;defs&gt;
&lt;symbol id=&#34;icon-database&#34; viewBox=&#34;0 0 32 32&#34;&gt;
&lt;path d=&#34;M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z&#34;&gt;&lt;/path&gt;
&lt;/symbol&gt;
&lt;symbol id=&#34;icon-file-text2&#34; viewBox=&#34;0 0 32 32&#34;&gt;
&lt;path d=&#34;M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;path d=&#34;M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z&#34;&gt;&lt;/path&gt;
&lt;/symbol&gt;
&lt;/defs&gt;
&lt;/svg&gt;
&lt;style&gt;/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */
&lt;p&gt;:root {
&amp;ndash;xr-font-color0: var(&amp;ndash;jp-content-font-color0, rgba(0, 0, 0, 1));
&amp;ndash;xr-font-color2: var(&amp;ndash;jp-content-font-color2, rgba(0, 0, 0, 0.54));
&amp;ndash;xr-font-color3: var(&amp;ndash;jp-content-font-color3, rgba(0, 0, 0, 0.38));
&amp;ndash;xr-border-color: var(&amp;ndash;jp-border-color2, #e0e0e0);
&amp;ndash;xr-disabled-color: var(&amp;ndash;jp-layout-color3, #bdbdbd);
&amp;ndash;xr-background-color: var(&amp;ndash;jp-layout-color0, white);
&amp;ndash;xr-background-color-row-even: var(&amp;ndash;jp-layout-color1, white);
&amp;ndash;xr-background-color-row-odd: var(&amp;ndash;jp-layout-color2, #eeeeee);
}&lt;/p&gt;
&lt;p&gt;html[theme=dark],
body.vscode-dark {
&amp;ndash;xr-font-color0: rgba(255, 255, 255, 1);
&amp;ndash;xr-font-color2: rgba(255, 255, 255, 0.54);
&amp;ndash;xr-font-color3: rgba(255, 255, 255, 0.38);
&amp;ndash;xr-border-color: #1F1F1F;
&amp;ndash;xr-disabled-color: #515151;
&amp;ndash;xr-background-color: #111111;
&amp;ndash;xr-background-color-row-even: #111111;
&amp;ndash;xr-background-color-row-odd: #313131;
}&lt;/p&gt;
&lt;p&gt;.xr-wrap {
display: block;
min-width: 300px;
max-width: 700px;
}&lt;/p&gt;
&lt;p&gt;.xr-text-repr-fallback {
/* fallback to plain text repr when CSS is not injected (untrusted notebook) */
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-header {
padding-top: 6px;
padding-bottom: 6px;
margin-bottom: 4px;
border-bottom: solid 1px var(&amp;ndash;xr-border-color);
}&lt;/p&gt;
&lt;p&gt;.xr-header &amp;gt; div,
.xr-header &amp;gt; ul {
display: inline;
margin-top: 0;
margin-bottom: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-obj-type,
.xr-array-name {
margin-left: 2px;
margin-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-obj-type {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-sections {
padding-left: 0 !important;
display: grid;
grid-template-columns: 150px auto auto 1fr 20px 20px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input + label {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input:enabled + label {
cursor: pointer;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-section-item input:enabled + label:hover {
color: var(&amp;ndash;xr-font-color0);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary {
grid-column: 1;
color: var(&amp;ndash;xr-font-color2);
font-weight: 500;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary &amp;gt; span {
display: inline-block;
padding-left: 0.5em;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:disabled + label {
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in + label:before {
display: inline-block;
content: &amp;lsquo;â–º&amp;rsquo;;
font-size: 11px;
width: 15px;
text-align: center;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:disabled + label:before {
color: var(&amp;ndash;xr-disabled-color);
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked + label:before {
content: &amp;lsquo;â–¼&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked + label &amp;gt; span {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary,
.xr-section-inline-details {
padding-top: 4px;
padding-bottom: 4px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-inline-details {
grid-column: 2 / -1;
}&lt;/p&gt;
&lt;p&gt;.xr-section-details {
display: none;
grid-column: 1 / -1;
margin-bottom: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-section-summary-in:checked ~ .xr-section-details {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-array-wrap {
grid-column: 1 / -1;
display: grid;
grid-template-columns: 20px auto;
}&lt;/p&gt;
&lt;p&gt;.xr-array-wrap &amp;gt; label {
grid-column: 1;
vertical-align: top;
}&lt;/p&gt;
&lt;p&gt;.xr-preview {
color: var(&amp;ndash;xr-font-color3);
}&lt;/p&gt;
&lt;p&gt;.xr-array-preview,
.xr-array-data {
padding: 0 5px !important;
grid-column: 2;
}&lt;/p&gt;
&lt;p&gt;.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
display: none;
}&lt;/p&gt;
&lt;p&gt;.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
display: inline-block;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list {
display: inline-block !important;
list-style: none;
padding: 0 !important;
margin: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list li {
display: inline-block;
padding: 0;
margin: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list:before {
content: &amp;lsquo;(&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list:after {
content: &amp;lsquo;)&amp;rsquo;;
}&lt;/p&gt;
&lt;p&gt;.xr-dim-list li:not(:last-child):after {
content: &amp;lsquo;,&amp;rsquo;;
padding-right: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-has-index {
font-weight: bold;
}&lt;/p&gt;
&lt;p&gt;.xr-var-list,
.xr-var-item {
display: contents;
}&lt;/p&gt;
&lt;p&gt;.xr-var-item &amp;gt; div,
.xr-var-item label,
.xr-var-item &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-even);
margin-bottom: 0;
}&lt;/p&gt;
&lt;p&gt;.xr-var-item &amp;gt; .xr-var-name:hover span {
padding-right: 5px;
}&lt;/p&gt;
&lt;p&gt;.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; div,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; label,
.xr-var-list &amp;gt; li:nth-child(odd) &amp;gt; .xr-var-name span {
background-color: var(&amp;ndash;xr-background-color-row-odd);
}&lt;/p&gt;
&lt;p&gt;.xr-var-name {
grid-column: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-var-dims {
grid-column: 2;
}&lt;/p&gt;
&lt;p&gt;.xr-var-dtype {
grid-column: 3;
text-align: right;
color: var(&amp;ndash;xr-font-color2);
}&lt;/p&gt;
&lt;p&gt;.xr-var-preview {
grid-column: 4;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
padding-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
overflow: visible;
width: auto;
z-index: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-var-attrs,
.xr-var-data {
display: none;
background-color: var(&amp;ndash;xr-background-color) !important;
padding-bottom: 5px !important;
}&lt;/p&gt;
&lt;p&gt;.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
display: block;
}&lt;/p&gt;
&lt;p&gt;.xr-var-data &amp;gt; table {
float: right;
}&lt;/p&gt;
&lt;p&gt;.xr-var-name span,
.xr-var-data,
.xr-attrs {
padding-left: 25px !important;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs,
.xr-var-attrs,
.xr-var-data {
grid-column: 1 / -1;
}&lt;/p&gt;
&lt;p&gt;dl.xr-attrs {
padding: 0;
margin: 0;
display: grid;
grid-template-columns: 125px auto;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt, dd {
padding: 0;
margin: 0;
float: left;
padding-right: 10px;
width: auto;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt {
font-weight: normal;
grid-column: 1;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dt:hover span {
display: inline-block;
background: var(&amp;ndash;xr-background-color);
padding-right: 10px;
}&lt;/p&gt;
&lt;p&gt;.xr-attrs dd {
grid-column: 2;
white-space: pre-wrap;
word-break: break-all;
}&lt;/p&gt;
&lt;p&gt;.xr-icon-database,
.xr-icon-file-text2 {
display: inline-block;
vertical-align: middle;
width: 1em;
height: 1.5em !important;
stroke-width: 0;
stroke: currentColor;
fill: currentColor;
}
&lt;/style&gt;&lt;pre class=&#39;xr-text-repr-fallback&#39;&gt;&amp;lt;xarray.Dataset&amp;gt;
Dimensions:    (lat: 181, lon: 360, time: 12)
Coordinates:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;lon        (lon) float32 -180.0 -179.0 -178.0 -177.0 &amp;hellip; 177.0 178.0 179.0&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;lat        (lat) float64 -89.75 -89.0 -88.0 -87.0 &amp;hellip; 87.0 88.0 89.0 89.75&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;time       (time) datetime64[ns] 1985-01-01 1985-02-01 &amp;hellip; 1985-12-01
Data variables:
DMS_OCEAN  (time, lat, lon) float32 0.0 0.0 &amp;hellip; 1.4103641e-07 1.4103641e-07
Attributes:
CDI:          Climate Data Interface version 1.6.4 (&lt;a href=&#34;http://code.zmaw.de/p&#34;&gt;http://code.zmaw.de/p&lt;/a&gt;&amp;hellip;
Conventions:  COARDS
history:      Mon Jul 20 16:29:35 2015: ncatted -O -a units,DMS_OCEAN,o,c&amp;hellip;
Title:        COARDS/netCDF file created by BPCH2COARDS (GAMAP v2-17+)
Format:       NetCDF-3
Model:        GEOS5_47L
Delta_Lon:    1.0
Delta_Lat:    1.0
NLayers:      47
Start_Date:   19850101
Start_Time:   0
End_Date:     19850201
End_Time:     0
Delta_Time:   744
CDO:          Climate Data Operators version 1.6.4 (&lt;a href=&#34;http://code.zmaw.de/p&#34;&gt;http://code.zmaw.de/p&lt;/a&gt;&amp;hellip;&lt;/pre&gt;&lt;div class=&#39;xr-wrap&#39; hidden&gt;&lt;div class=&#39;xr-header&#39;&gt;&lt;div class=&#39;xr-obj-type&#39;&gt;xarray.Dataset&lt;/div&gt;&lt;/div&gt;&lt;ul class=&#39;xr-sections&#39;&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-1d3973d5-86e2-4ae2-8251-1976aa014d57&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39; disabled &gt;&lt;label for=&#39;section-1d3973d5-86e2-4ae2-8251-1976aa014d57&#39; class=&#39;xr-section-summary&#39;  title=&#39;Expand/collapse section&#39;&gt;Dimensions:&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;ul class=&#39;xr-dim-list&#39;&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lat&lt;/span&gt;: 181&lt;/li&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lon&lt;/span&gt;: 360&lt;/li&gt;&lt;li&gt;&lt;span class=&#39;xr-has-index&#39;&gt;time&lt;/span&gt;: 12&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-38a92b18-c082-4373-9eac-1db42a49da98&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39;  checked&gt;&lt;label for=&#39;section-38a92b18-c082-4373-9eac-1db42a49da98&#39; class=&#39;xr-section-summary&#39; &gt;Coordinates: &lt;span&gt;(3)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;ul class=&#39;xr-var-list&#39;&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lon&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(lon)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float32&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;-180.0 -179.0 &amp;hellip; 178.0 179.0&lt;/div&gt;&lt;input id=&#39;attrs-788cb713-2b62-4fb9-9e24-fd5b7eb6d7f9&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-788cb713-2b62-4fb9-9e24-fd5b7eb6d7f9&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-c02e4d32-7724-4337-904d-a6812682f881&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-c02e4d32-7724-4337-904d-a6812682f881&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;longitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Longitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;units :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;degrees_east&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;axis :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;X&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([-180., -179., -178., &amp;hellip;,  177.,  178.,  179.], dtype=float32)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;lat&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(lat)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float64&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;-89.75 -89.0 -88.0 &amp;hellip; 89.0 89.75&lt;/div&gt;&lt;input id=&#39;attrs-891d4fdd-a055-4fb9-a5f9-6d7ab0826be5&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-891d4fdd-a055-4fb9-a5f9-6d7ab0826be5&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-5f96b15e-d0a2-4e05-9bee-9ca9e9498da1&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-5f96b15e-d0a2-4e05-9bee-9ca9e9498da1&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;latitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Latitude&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;units :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;degrees_north&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;axis :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Y&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([-89.75, -89.  , -88.  , -87.  , -86.  , -85.  , -84.  , -83.  , -82.  ,
-81.  , -80.  , -79.  , -78.  , -77.  , -76.  , -75.  , -74.  , -73.  ,
-72.  , -71.  , -70.  , -69.  , -68.  , -67.  , -66.  , -65.  , -64.  ,
-63.  , -62.  , -61.  , -60.  , -59.  , -58.  , -57.  , -56.  , -55.  ,
-54.  , -53.  , -52.  , -51.  , -50.  , -49.  , -48.  , -47.  , -46.  ,
-45.  , -44.  , -43.  , -42.  , -41.  , -40.  , -39.  , -38.  , -37.  ,
-36.  , -35.  , -34.  , -33.  , -32.  , -31.  , -30.  , -29.  , -28.  ,
-27.  , -26.  , -25.  , -24.  , -23.  , -22.  , -21.  , -20.  , -19.  ,
-18.  , -17.  , -16.  , -15.  , -14.  , -13.  , -12.  , -11.  , -10.  ,
-9.  ,  -8.  ,  -7.  ,  -6.  ,  -5.  ,  -4.  ,  -3.  ,  -2.  ,  -1.  ,
0.  ,   1.  ,   2.  ,   3.  ,   4.  ,   5.  ,   6.  ,   7.  ,   8.  ,
9.  ,  10.  ,  11.  ,  12.  ,  13.  ,  14.  ,  15.  ,  16.  ,  17.  ,
18.  ,  19.  ,  20.  ,  21.  ,  22.  ,  23.  ,  24.  ,  25.  ,  26.  ,
27.  ,  28.  ,  29.  ,  30.  ,  31.  ,  32.  ,  33.  ,  34.  ,  35.  ,
36.  ,  37.  ,  38.  ,  39.  ,  40.  ,  41.  ,  42.  ,  43.  ,  44.  ,
45.  ,  46.  ,  47.  ,  48.  ,  49.  ,  50.  ,  51.  ,  52.  ,  53.  ,
54.  ,  55.  ,  56.  ,  57.  ,  58.  ,  59.  ,  60.  ,  61.  ,  62.  ,
63.  ,  64.  ,  65.  ,  66.  ,  67.  ,  68.  ,  69.  ,  70.  ,  71.  ,
72.  ,  73.  ,  74.  ,  75.  ,  76.  ,  77.  ,  78.  ,  79.  ,  80.  ,
81.  ,  82.  ,  83.  ,  84.  ,  85.  ,  86.  ,  87.  ,  88.  ,  89.  ,
89.75])&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span class=&#39;xr-has-index&#39;&gt;time&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(time)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;datetime64[ns]&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;1985-01-01 &amp;hellip; 1985-12-01&lt;/div&gt;&lt;input id=&#39;attrs-d33c5a14-55c5-4dce-a8fd-f722ce9d07ba&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-d33c5a14-55c5-4dce-a8fd-f722ce9d07ba&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-10b905e2-8b1a-49ff-b1f5-fbc9c2b93b64&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-10b905e2-8b1a-49ff-b1f5-fbc9c2b93b64&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;standard_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;time&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Time&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([&#39;1985-01-01T00:00:00.000000000&#39;, &#39;1985-02-01T00:00:00.000000000&#39;,
&#39;1985-03-01T00:00:00.000000000&#39;, &#39;1985-04-01T00:00:00.000000000&#39;,
&#39;1985-05-01T00:00:00.000000000&#39;, &#39;1985-06-01T00:00:00.000000000&#39;,
&#39;1985-07-01T00:00:00.000000000&#39;, &#39;1985-08-01T00:00:00.000000000&#39;,
&#39;1985-09-01T00:00:00.000000000&#39;, &#39;1985-10-01T00:00:00.000000000&#39;,
&#39;1985-11-01T00:00:00.000000000&#39;, &#39;1985-12-01T00:00:00.000000000&#39;],
dtype=&#39;datetime64[ns]&#39;)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-8da54277-6e2d-4426-825c-1252d422138d&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39;  checked&gt;&lt;label for=&#39;section-8da54277-6e2d-4426-825c-1252d422138d&#39; class=&#39;xr-section-summary&#39; &gt;Data variables: &lt;span&gt;(1)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;ul class=&#39;xr-var-list&#39;&gt;&lt;li class=&#39;xr-var-item&#39;&gt;&lt;div class=&#39;xr-var-name&#39;&gt;&lt;span&gt;DMS_OCEAN&lt;/span&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-dims&#39;&gt;(time, lat, lon)&lt;/div&gt;&lt;div class=&#39;xr-var-dtype&#39;&gt;float32&lt;/div&gt;&lt;div class=&#39;xr-var-preview xr-preview&#39;&gt;0.0 0.0 &amp;hellip; 1.4103641e-07&lt;/div&gt;&lt;input id=&#39;attrs-314e0691-5a50-49d4-8410-a52c58f6afc7&#39; class=&#39;xr-var-attrs-in&#39; type=&#39;checkbox&#39; &gt;&lt;label for=&#39;attrs-314e0691-5a50-49d4-8410-a52c58f6afc7&#39; title=&#39;Show/Hide attributes&#39;&gt;&lt;svg class=&#39;icon xr-icon-file-text2&#39;&gt;&lt;use xlink:href=&#39;#icon-file-text2&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;input id=&#39;data-fef84fbf-75c5-40b3-ba4c-d35a3771d1f6&#39; class=&#39;xr-var-data-in&#39; type=&#39;checkbox&#39;&gt;&lt;label for=&#39;data-fef84fbf-75c5-40b3-ba4c-d35a3771d1f6&#39; title=&#39;Show/Hide data repr&#39;&gt;&lt;svg class=&#39;icon xr-icon-database&#39;&gt;&lt;use xlink:href=&#39;#icon-database&#39;&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/label&gt;&lt;div class=&#39;xr-var-attrs&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;long_name :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Ocean DMS concentration&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;units :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;kg/m3&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;div class=&#39;xr-var-data&#39;&gt;&lt;pre&gt;array([[[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
&amp;hellip;,
[1.0823291e-07, 1.0823291e-07, 1.0823291e-07, &amp;hellip;,
1.0823291e-07, 1.0823291e-07, 1.0823291e-07],
[1.0823292e-07, 1.0823292e-07, 1.0823292e-07, &amp;hellip;,
1.0823292e-07, 1.0823292e-07, 1.0823292e-07],
[2.1647536e-07, 2.1647536e-07, 2.1647536e-07, &amp;hellip;,
2.1647536e-07, 2.1647536e-07, 2.1647536e-07]],&lt;/p&gt;
&lt;p&gt;[[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
&amp;hellip;
[4.1650505e-08, 4.1650505e-08, 4.1650505e-08, &amp;hellip;,
4.1650505e-08, 4.1650505e-08, 4.1650505e-08],
[4.1650505e-08, 4.1650505e-08, 4.1650505e-08, &amp;hellip;,
4.1650505e-08, 4.1650505e-08, 4.1650505e-08],
[8.3304677e-08, 8.3304677e-08, 8.3304677e-08, &amp;hellip;,
8.3304677e-08, 8.3304677e-08, 8.3304677e-08]],&lt;/p&gt;
&lt;p&gt;[[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, &amp;hellip;,
0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
&amp;hellip;,
[7.0515100e-08, 7.0515100e-08, 7.0515100e-08, &amp;hellip;,
7.0515100e-08, 7.0515100e-08, 7.0515100e-08],
[7.0515107e-08, 7.0515107e-08, 7.0515107e-08, &amp;hellip;,
7.0515107e-08, 7.0515107e-08, 7.0515107e-08],
[1.4103641e-07, 1.4103641e-07, 1.4103641e-07, &amp;hellip;,
1.4103641e-07, 1.4103641e-07, 1.4103641e-07]]], dtype=float32)&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=&#39;xr-section-item&#39;&gt;&lt;input id=&#39;section-a5022503-e091-4ad2-a439-4f7e4b523a52&#39; class=&#39;xr-section-summary-in&#39; type=&#39;checkbox&#39;  &gt;&lt;label for=&#39;section-a5022503-e091-4ad2-a439-4f7e4b523a52&#39; class=&#39;xr-section-summary&#39; &gt;Attributes: &lt;span&gt;(15)&lt;/span&gt;&lt;/label&gt;&lt;div class=&#39;xr-section-inline-details&#39;&gt;&lt;/div&gt;&lt;div class=&#39;xr-section-details&#39;&gt;&lt;dl class=&#39;xr-attrs&#39;&gt;&lt;dt&gt;&lt;span&gt;CDI :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Climate Data Interface version 1.6.4 (&lt;a href=&#34;http://code.zmaw.de/projects/cdi&#34;&gt;http://code.zmaw.de/projects/cdi&lt;/a&gt;)&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Conventions :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;COARDS&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;history :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Mon Jul 20 16:29:35 2015: ncatted -O -a units,DMS_OCEAN,o,c,kg/m3 tmp3.nc
Mon Jul 20 16:29:34 2015: cdo mulc,6.213e-8 tmp2.nc tmp3.nc
Mon Jul 20 16:29:34 2015: cdo chname,BIOGSRCE__DMSOCN,DMS_OCEAN tmp.nc tmp2.nc
Mon Jul 20 16:29:34 2015: cdo mergetime tmp.1985*.nc tmp.nc&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Title :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;COARDS/netCDF file created by BPCH2COARDS (GAMAP v2-17+)&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Format :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;NetCDF-3&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Model :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;GEOS5_47L&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Delta_Lon :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;1.0&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Delta_Lat :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;1.0&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;NLayers :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;47&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Start_Date :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;19850101&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Start_Time :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;0&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;End_Date :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;19850201&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;End_Time :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;0&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;Delta_Time :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;744&lt;/dd&gt;&lt;dt&gt;&lt;span&gt;CDO :&lt;/span&gt;&lt;/dt&gt;&lt;dd&gt;Climate Data Operators version 1.6.4 (&lt;a href=&#34;http://code.zmaw.de/projects/cdo&#34;&gt;http://code.zmaw.de/projects/cdo&lt;/a&gt;)&lt;/dd&gt;&lt;/dl&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;finally-save-the-scaled-dms-in-a-new-file&#34;&gt;Finally, save the scaled DMS in a new file&lt;/h2&gt;
&lt;p&gt;And, it&amp;rsquo;s one-line easy.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds_new&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_netcdf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;DMS_lana.geos.1x1.SouthernHalved.nc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# always good to have a descriptive name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Again, I know that it&amp;rsquo;s likely not the best way. Please let me know if you have a smarter way. I am always open to learn!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Python &amp; R on Cheyenne/Casper</title>
      <link>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2020-11-13-using-r-python-cheyenne/</link>
      <pubDate>Fri, 13 Nov 2020 00:00:00 -0500</pubDate>
      <guid>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2020-11-13-using-r-python-cheyenne/</guid>
      <description>&lt;p&gt;I am lucky enough to have an access to NCAR&amp;rsquo;s super computing facilities - Cheyenne allows me to run CESM simulation with hundreds of cores while Casper streamlines my data processing, analysis, and visualization without wasting time to transfer large files. But, setting up the correct software to full deploy these machines are a pain in the neck. Here I would like to share how I set up my &lt;code&gt;Jupyter&lt;/code&gt; environment to run &lt;code&gt;R&lt;/code&gt; and &lt;code&gt;Python&lt;/code&gt; on these two supercomputers.&lt;/p&gt;
&lt;h3 id=&#34;what-does-ncar-say&#34;&gt;What does NCAR say&lt;/h3&gt;
&lt;p&gt;NCAR has been putting a lot of efforts in modernizing their legendary NCL libraries and translating them into Python packages. In this &lt;a href=&#34;https://www2.cisl.ucar.edu/resources/python-%E2%80%93-ncar-package-library&#34;&gt;guide&lt;/a&gt;, they lay out the easiest way to use &lt;code&gt;Python&lt;/code&gt; with &lt;code&gt;Jupyter&lt;/code&gt; on Casper.&lt;/p&gt;
&lt;p&gt;The idea is to use &lt;code&gt;module&lt;/code&gt; the default environment managing software on Casper to load the pre-bundled package:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;module load ncarenv
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then, you can run&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ncar_pylib -p 20200417
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;to check what packages are pre-installed. If you are happy with it, activate the default package library by invoking&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ncar_pylib
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It should allow you to use &lt;code&gt;Python&lt;/code&gt; and other common packages including &lt;code&gt;matplotlib&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;running-jupyter-on-casper&#34;&gt;Running &lt;code&gt;Jupyter&lt;/code&gt; on Casper&lt;/h3&gt;
&lt;p&gt;NCAR is experimenting a simple way to run &lt;code&gt;Jupyter&lt;/code&gt; using &lt;code&gt;JupyterHub&lt;/code&gt; (&lt;a href=&#34;https://www2.cisl.ucar.edu/resources/jupyterhub-ncar&#34;&gt;Visit here for details&lt;/a&gt;) which can bypass using the &lt;code&gt;Terminal&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Alternatively, the old-fashion &lt;code&gt;IPython&lt;/code&gt; approach to run &lt;code&gt;Jupyter&lt;/code&gt; can also be found &lt;a href=&#34;https://www2.cisl.ucar.edu/resources/jupyter-and-ipython&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;i-wanted-to-include-r&#34;&gt;I wanted to include &lt;code&gt;R&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;To include more packages and other software, I needed to create my own environment &lt;code&gt;my_npl_clone&lt;/code&gt;. For that, I invoked,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ncar_pylib -c 20200417 /glade/work/$USER/my_npl_clone
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;to create a clone of the environment &lt;code&gt;20200417&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Activating the new environment with&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ncar_pylib my_npl_clone
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I also install &lt;code&gt;Miniconda&lt;/code&gt; - a package management software for &lt;code&gt;Python&lt;/code&gt; and &lt;code&gt;R&lt;/code&gt;, which helps me to create &lt;code&gt;R&lt;/code&gt; directories under my home dir and enables installing package without the &lt;code&gt;root&lt;/code&gt; access right.&lt;/p&gt;
&lt;h4 id=&#34;installing-miniconda&#34;&gt;Installing &lt;code&gt;Miniconda&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;In my &lt;code&gt;$HOME&lt;/code&gt; directory, I first download the installation file for &lt;code&gt;Miniconda&lt;/code&gt;,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;then install it by invoking,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bash Miniconda3-latest-Linux-x86_64.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;reviewing the documentation and set up the locations.&lt;/p&gt;
&lt;p&gt;After the installation, I can see they modified my &lt;code&gt;.bashrc&lt;/code&gt;. To use &lt;code&gt;Miniconda&lt;/code&gt;, I had to run&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;source .bashrc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(This part may be a bit different for you depending on your settings. Feel free to contact me for details.)&lt;/p&gt;
&lt;p&gt;For better file management, I created a new environment for &lt;code&gt;R&lt;/code&gt; and named it &lt;code&gt;r&lt;/code&gt; based on two preset library sets &lt;code&gt;r-essentials&lt;/code&gt; and &lt;code&gt;r-base&lt;/code&gt;,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;conda create -n r -c conda-forge r-base=4.0.2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;conda&lt;/code&gt; environment is ready to use by running,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;conda activate r
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;By adding &lt;code&gt;R&lt;/code&gt; and &lt;code&gt;my_npl_clone&lt;/code&gt; to &lt;code&gt;Jupyter&lt;/code&gt;&amp;rsquo;s kernel, I invoked,&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;conda install -c r r-irkernel
ncar_pylib --kernel my_npl_clone
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Both should be online for &lt;code&gt;Jupyter&lt;/code&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Python Basics for CESM</title>
      <link>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2020-10-03-python_basics_cesm/</link>
      <pubDate>Sat, 03 Oct 2020 16:05:04 -0400</pubDate>
      <guid>https://kamingfung.github.io/kamingfung.github.io.academic_cv/post/2020-10-03-python_basics_cesm/</guid>
      <description>&lt;!-- *Created by [Ka Ming Fung](kamingfung@link.cuhk.edu.hk)* --&gt;
&lt;h2 id=&#34;references&#34;&gt;References:&lt;/h2&gt;
&lt;p&gt;For general python handling of nc files: &lt;a href=&#34;https://github.com/geoschem/GEOSChem-python-tutorial&#34;&gt;https://github.com/geoschem/GEOSChem-python-tutorial&lt;/a&gt;
&lt;br/&gt;
For NCL plot styles: &lt;a href=&#34;http://www.pyngl.ucar.edu/&#34;&gt;http://www.pyngl.ucar.edu/&lt;/a&gt;
&lt;br/&gt;
For merging nc files: &lt;a href=&#34;https://medium.com/@neetinayak/combine-many-netcdf-files-into-a-single-file-with-python-469ba476fc14&#34;&gt;https://medium.com/@neetinayak/combine-many-netcdf-files-into-a-single-file-with-python-469ba476fc14&lt;/a&gt;
&lt;br/&gt;
For NCL color scales: &lt;a href=&#34;https://github.com/hhuangwx/cmaps&#34;&gt;https://github.com/hhuangwx/cmaps&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This is an example to show how to combine multiple ncdf files, compute annual means, and make plots.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;numpy&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;np&lt;/span&gt;                    &lt;span class=&#34;c1&#34;&gt;# for better array&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;xarray&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;xr&lt;/span&gt;                   &lt;span class=&#34;c1&#34;&gt;# the major tool to work with NetCDF data!&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;merging-monthly-nc-files&#34;&gt;Merging monthly .nc files&lt;/h2&gt;
&lt;p&gt;Below is a list of files for this example. They are nc files named after case name, for each month in 2016.
&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;Note that we could use, in the code, % (magic link) to call a function on the shell level.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ls&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/*.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nc&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-01.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-02.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-03.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-04.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-05.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-06.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-07.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-08.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-09.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-10.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-11.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.h0.2016-12.nc
_data/FC2000climo.f19_f19.2_1_MOSAIC.OAS_KPP_ISO.cam.i.2017-01-01-00000.nc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We use the function xr.open_mfdataset from the xarray package. specifying the &amp;ldquo;names, &lt;strong&gt;combining&lt;/strong&gt; &lt;em&gt;method&lt;/em&gt; and &lt;em&gt;dimension&lt;/em&gt; for &lt;strong&gt;concatenation&lt;/strong&gt;. Note the use of * as a wildcard.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;open_mfdataset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_data/*.cam.h0.2016-*.nc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;combine&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;by_coords&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;concat_dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ds&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Done! Couldn&amp;rsquo;t imagine life can be this easy :P&lt;/p&gt;
&lt;h2 id=&#34;computing-global-and-annual-mean-surface-value-of-variables-of-interest&#34;&gt;Computing global and annual-mean surface value of variables of interest&lt;/h2&gt;
&lt;p&gt;We want to extract the variables concerned using some string selection tracks, for instance &amp;ldquo;startswith&amp;rdquo; here.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;keys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;startswith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;r_is&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# dr&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then, we &amp;ldquo;slice&amp;rdquo; the surface layers out from the big dataset.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dr&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lev&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;slice&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# lev is in hPa. Here I assume troposphere is within 1000hPa-100hPa&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# dr_surf&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Do a quick check on the global mean values.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;bound method Mapping.values of &amp;lt;xarray.Dataset&amp;gt;
Dimensions:                ()
Data variables:
    r_is_HOOCH2SCH2O       float32 11.503614
    r_is_HOOCH2SCO_1       float32 368.33008
    r_is_HOOCH2SCO_2       float32 0.021772318
    r_is_HOOCH2SO_NO2      float32 11.119194
    r_is_HOOCH2SO_O3       float32 368.70016
    r_is_HOOCH2S_NO2       float32 10.201074
    r_is_HOOCH2S_O3        float32 369.6315
    r_is_HPMTF_OH          float32 368.35184
    r_is_OOCH2SCH2OOH_HO2  float32 12.836186
    r_is_OOCH2SCH2OOH_NO   float32 11.503614
    r_is_shift_1           float32 1240.3165
    r_is_shift_2           float32 1215.9198&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ok, they are about right.&lt;/p&gt;
&lt;h2 id=&#34;plotting-variables-on-maps&#34;&gt;Plotting variables on maps&lt;/h2&gt;
&lt;p&gt;To plot variables, we employ the powerful and (most) popular packages:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;matplotlib&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inline&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;matplotlib&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pyplot&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# for plotting&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here, we want to plot variable, r_is_shift_1, which is a 4-D array (lon, lat, lev, and time).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;r_is_shift_1&amp;#34;&lt;/span&gt;                  &lt;span class=&#34;c1&#34;&gt;# storing the variable id for easier recall&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# dr_surf[vid]                          # just to double check if the array is what we want&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# actual plotting codes:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;# defining the canvas with size 14 x 4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;                       &lt;span class=&#34;c1&#34;&gt;# defining the axes (Cartesian rectangle)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lev&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# two operations happened here, this line first compute the mean along lev and time dimensions of the array and then make the plot&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;matplotlib.collections.QuadMesh at 0x2b0b7a6006d0&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_18_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Hurray, we got our nice plot. But who would stop here?
&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;Time to play around the codes and make some aesthetic changes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Change 1: Projection - People have been arguing about which map projection is the best to maintain the &amp;#34;shape&amp;#34; of the Earth.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# One popular choice is the Robinson&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# So this is how we do it.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;cartopy&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;crs&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;       &lt;span class=&#34;c1&#34;&gt;# for map projections&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;# again, defining the canvas&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;projection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Robinson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# defining the axes after Robinson projection&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;lev&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transform&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PlateCarree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# two operations here: computing the mean, and transforming the retangular grids onto a Robinson-projected coordinate system&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;matplotlib.collections.QuadMesh at 0x2b0b7a4fd310&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_20_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Change 2: Coastline - Land-sea difference of some variables are not that obvisous so we also draw coastal lines for better readability&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;projection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Robinson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;lev&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transform&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PlateCarree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;coastlines&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;w&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# this line adds coastlines to the coordinate system (aka axes in the language of matplotlib), and we used white&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;cartopy.mpl.feature_artist.FeatureArtist at 0x2b0b7a6d4610&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_21_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Change 3: Color Scale - the default color scale of matplotlib is a color-blindness-friendly one but some community like to use their own color scales.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# For example, this popular White-Blue-Green-Yellow-Red scale:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;matplotlib&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;colors&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;# for making color schemes from Ngl applicable to matplot-style plots&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;cmaps&lt;/span&gt;                          &lt;span class=&#34;c1&#34;&gt;# packages for NCL color options&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;projection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Robinson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;lev&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transform&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PlateCarree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                            &lt;span class=&#34;n&#34;&gt;cmap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmaps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WhiteBlueGreenYellowRed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# assigning the color scale&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;coastlines&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# now we use black coastal lines&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;cartopy.mpl.feature_artist.FeatureArtist at 0x2b0b7cb88f10&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_22_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Change 4: Color Steps or discretized color scale - Some scientists advocate for minimial color shades for better comparison.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# This is how we do that.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;projection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Robinson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;lev&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transform&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PlateCarree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                            &lt;span class=&#34;n&#34;&gt;cmap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmaps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WhiteBlueGreenYellowRed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                            &lt;span class=&#34;n&#34;&gt;levels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;coastlines&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;cartopy.mpl.feature_artist.FeatureArtist at 0x2b0b7cb45850&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_23_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Change 5: Titles and Labels - They are simply essential for all plots.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;projection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Robinson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ms&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;lev&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transform&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PlateCarree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;cmap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmaps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WhiteBlueGreenYellowRed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;levels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;add_colorbar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# Omitting the original colorbar.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# I haven&amp;#39;t find how to change title using the build-in attribute of xarray so I recreate the color using the matplotlib function like this&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;colorbar_obj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;colorbar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;colorbar_obj&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;molecules cm$^{-3}$ s$^{-1}$&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# adding the unit to the colorbar&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;coastlines&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Surface &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;(global and annual mean)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# adding a title to the plot&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;Text(0.5, 1.0, &#39;Surface r_is_shift_1(global and annual mean)&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_24_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# Bonus Change: Showing smaller values only - sometimes some data are just too large that the color scale, &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# we would want to put a maximum on the values to show, we set that cap at 6000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;projection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Robinson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ms&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;lev&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transform&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PlateCarree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;cmap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmaps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WhiteBlueGreenYellowRed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;levels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;add_colorbar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;vmax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# setting the variable using vmax and vmin&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# I haven&amp;#39;t found how to change title using the build-in attribute of xarray so I recreate the color using the matplotlib function like this&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;colorbar_obj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;colorbar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;colorbar_obj&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;molecules cm$^{-3}$ s$^{-1}$&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;coastlines&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Surface &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34; (global and annual mean)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;Text(0.5, 1.0, &#39;Surface r_is_shift_1 (global and annual mean)&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;output_25_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;saving-the-figure&#34;&gt;Saving the figure&lt;/h2&gt;
&lt;p&gt;Now we have done some simple post-processing. Let&amp;rsquo;s output the plot for publication!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;fig&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;projection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Robinson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ms&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dr_surf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dim&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;lev&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;transform&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ccrs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PlateCarree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;cmap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cmaps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WhiteBlueGreenYellowRed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;levels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;add_colorbar&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                                 &lt;span class=&#34;n&#34;&gt;vmax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;colorbar_obj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;colorbar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;colorbar_obj&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;molecules cm$^{-3}$ s$^{-1}$&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;coastlines&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Surface &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34; (global and annual mean)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;savefig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Figure1.png&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# we can simply specify the wanted file type in the filename&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;output_27_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;And a png.file is created in under the same directory.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ls&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;png&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;Figure1.png
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>
